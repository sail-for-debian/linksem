chapter {* Generated by Lem from abis/power64/abi_power64_dynamic.lem. *}

theory "Abi_power64_dynamic" 

imports 
 	 Main
	 "../../lem-libs/isabelle-lib/Lem_num" 
	 "../../lem-libs/isabelle-lib/Lem_basic_classes" 
	 "../../lem-libs/isabelle-lib/Lem_string" 
	 "Show" 
	 "Error" 
	 "Elf_types_native_uint" 
	 "String_table" 
	 "Elf_dynamic" 

begin 

(*open import Basic_classes*)
(*open import Num*)
(*open import String*)

(*open import Error*)
(*open import Show*)
(*open import String_table*)

(*open import Elf_dynamic*)
(*open import Elf_types_native_uint*)

definition abi_power64_dt_ppcgot  :: " nat "  where 
     " abi_power64_dt_ppcgot = ( (( 939524096 :: nat) *( 2 :: nat)))"
 (* 0x70000000 *)

(*val string_of_abi_power64_dynamic_tag : natural -> string*)
definition string_of_abi_power64_dynamic_tag  :: " nat \<Rightarrow> string "  where 
     " string_of_abi_power64_dynamic_tag m = (
  if m = abi_power64_dt_ppcgot then
    (''PPC64_GLINK'')
  else
    (''Invalid Power64 dynamic tag''))"


(*val abi_power64_tag_correspondence_of_tag : natural -> error tag_correspondence*)
definition abi_power64_tag_correspondence_of_tag  :: " nat \<Rightarrow>(tag_correspondence)error "  where 
     " abi_power64_tag_correspondence_of_tag m = (
  if m = abi_power64_dt_ppcgot then
    error_return C_Ptr
  else
    error_fail ((''abi_power64_tag_correspondence_of_tag: invalid Power64 dynamic tag'')))"

    
(*val abi_power64_elf64_value_of_elf64_dyn : elf64_dyn -> string_table -> error elf64_dyn_value*)
definition abi_power64_elf64_value_of_elf64_dyn  :: " elf64_dyn \<Rightarrow> string_table \<Rightarrow>(((Elf_Types_Local.uint64),(uint64))dyn_value)error "  where 
     " abi_power64_elf64_value_of_elf64_dyn dyn stbl = (
  (let tag = (nat (abs (sint(elf64_dyn_tag   dyn)))) in
    if tag = abi_power64_dt_ppcgot then
      (case (elf64_dyn_d_un   dyn) of
          D_Val     v => error_fail (''abi_power64_elf64_value_of_elf64_dyn: PPC_GOT must be a PTR'')
        | D_Ptr     p => error_return p
        | D_Ignored i => error_fail (''abi_power64_elf64_value_of_elf64_dyn: PPC_GOT must be a PTR'')
      ) >>= (\<lambda> addr . 
      error_return (Address addr))
    else
      error_fail ((''abi_power64_elf64_value_of_elf64_dyn: invalid Power64 dynamic tag''))))"

end
